<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus R√©visions ISEP - Excellence Acad√©mique</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Configuration MathJax -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                tags: 'ams'
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c5aa0;
            --primary-dark: #1e3d72;
            --secondary: #4CAF50;
            --accent: #FF6B35;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border-radius: 8px;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: var(--light);
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
            border: none;
            font-family: inherit;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .main-header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .nav-link {
            font-weight: 500;
            padding: 8px 0;
            position: relative;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--primary);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .login-btn, .logout-btn {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .login-btn:hover, .logout-btn:hover {
            background: var(--primary-dark);
        }

        .logout-btn {
            background: var(--gray);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Hero Section */
        .hero-section {
            padding: 80px 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            align-items: center;
        }

        .tagline {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 20px;
        }

        .hero-description {
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .hero-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--accent);
            color: white;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-weight: 600;
            transition: var(--transition);
        }

        .cta-button:hover {
            background: #e55a2b;
            transform: translateY(-2px);
        }

        .cta-button.secondary {
            background: transparent;
            border: 2px solid white;
        }

        .cta-button.secondary:hover {
            background: white;
            color: var(--primary);
        }

        .hero-image {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hero-image-placeholder {
            width: 100%;
            height: 300px;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.2) 100%);
            border-radius: var(--border-radius);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            color: rgba(255,255,255,0.7);
        }

        /* Trust Badges */
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
        }

        .trust-badge i {
            color: var(--secondary);
        }

        /* Stats Bar */
        .stats-bar {
            background: white;
            padding: 40px 0;
            box-shadow: var(--shadow);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--gray);
            font-weight: 500;
        }

        /* Sections */
        .section {
            padding: 80px 0;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .section-description {
            text-align: center;
            max-width: 700px;
            margin: 0 auto 40px;
            color: var(--gray);
            font-size: 1.1rem;
        }

        .separator {
            border: none;
            height: 1px;
            background: var(--light-gray);
            margin: 40px 0;
        }

        /* Progress Indicator */
        .progress-indicator {
            background: var(--light);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            display: none;
        }

        .progress-bar {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--secondary);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        /* TD Grid */
        .td-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .td-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary);
            cursor: pointer;
        }

        .td-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .td-card.completed {
            border-left-color: var(--secondary);
        }

        .locked-card {
            opacity: 0.7;
            background: var(--light-gray);
            cursor: not-allowed;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .td-card h3 {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .difficulty {
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }

        .difficulty.easy {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .difficulty.medium {
            background: #fff3e0;
            color: #ef6c00;
        }

        .difficulty.hard {
            background: #ffebee;
            color: #c62828;
        }

        .card-footer {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
        }

        .completion-badge {
            color: var(--secondary);
            font-weight: 600;
        }

        .time-estimate {
            color: var(--gray);
        }

        .locked-badge {
            color: var(--gray);
        }

        /* Telecom Features */
        .telecom-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .feature {
            text-align: center;
            padding: 30px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .feature:hover {
            transform: translateY(-5px);
        }

        .feature i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .feature h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .secondary-cta {
            display: block;
            width: fit-content;
            margin: 30px auto 0;
            background: var(--primary);
        }

        .secondary-cta:hover {
            background: var(--primary-dark);
        }

        /* Testimonials */
        .testimonials {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .testimonial {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            position: relative;
        }

        .testimonial::before {
            content: '"';
            font-size: 4rem;
            color: var(--light-gray);
            position: absolute;
            top: 10px;
            left: 20px;
            line-height: 1;
        }

        .testimonial-content {
            margin-bottom: 20px;
            font-style: italic;
            position: relative;
            z-index: 1;
        }

        .testimonial-author {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .testimonial-author strong {
            color: var(--primary);
        }

        .testimonial-author span {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Newsletter */
        .newsletter-section {
            background: var(--light);
            padding: 60px 0;
            text-align: center;
        }

        .newsletter-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .newsletter-form {
            display: flex;
            gap: 10px;
            margin: 30px 0 20px;
        }

        .newsletter-form input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
        }

        .privacy-note {
            font-size: 0.85rem;
            color: var(--gray);
        }

        /* Footer */
        .main-footer {
            background: var(--dark);
            color: white;
            padding: 40px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .footer-column h4 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: #adb5bd;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid #495057;
            padding-top: 20px;
            text-align: center;
            color: #adb5bd;
            font-size: 0.9rem;
        }

        .legal-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        .legal-links a {
            color: #adb5bd;
            font-size: 0.8rem;
        }

        .legal-links a:hover {
            color: white;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .input-help {
            display: block;
            margin-top: 5px;
            font-size: 0.8rem;
            color: var(--gray);
        }

        .modal-note {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 20px;
            text-align: center;
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 0;
            border-radius: 8px;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 400px;
            animation: slideInRight 0.3s ease;
        }

        .notification.success {
            background: var(--secondary);
            color: white;
        }

        .notification.error {
            background: #f44336;
            color: white;
        }

        .notification.info {
            background: var(--primary);
            color: white;
        }

        .notification-content {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .notification-close {
            background: none;
            border: none;
            color: inherit;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: 15px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Legal Pages */
        .legal-content {
            max-width: 800px;
            margin: 40px auto;
            background: white;
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .legal-content h1 {
            color: var(--primary);
            margin-bottom: 30px;
            text-align: center;
        }

        .legal-content h2 {
            color: var(--primary-dark);
            margin: 30px 0 15px;
            font-size: 1.5rem;
        }

        .legal-content h3 {
            color: var(--dark);
            margin: 20px 0 10px;
            font-size: 1.2rem;
        }

        .legal-content p {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        .legal-content ul, .legal-content ol {
            margin: 15px 0;
            padding-left: 25px;
        }

        .legal-content li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .highlight-box {
            background: var(--light);
            padding: 20px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary);
            margin: 20px 0;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-content {
                grid-template-columns: 1fr 1fr;
                gap: 30px;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-actions {
                justify-content: center;
            }
            
            .newsletter-form {
                flex-direction: column;
            }
            
            .td-grid {
                grid-template-columns: 1fr;
            }
            
            .trust-badges {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 576px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .testimonials {
                grid-template-columns: 1fr;
            }
            
            .telecom-features {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
            }
            
            .legal-links {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Modal de connexion -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Connexion √† Focus ISEP</h2>
            
            <div class="highlight-box">
                <h4>üîí Vos donn√©es sont s√©curis√©es</h4>
                <p style="font-size: 0.9rem; margin: 0;">Nous utilisons ces informations uniquement pour votre progression personnelle. Aucune utilisation commerciale ou partage avec des tiers.</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Pseudo *</label>
                    <input type="text" id="username" name="username" required minlength="3">
                    <small class="input-help">Minimum 3 caract√®res</small>
                </div>
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" name="email" required>
                    <small class="input-help">Votre email ISEP de pr√©f√©rence</small>
                </div>
                <button type="submit" class="cta-button" id="loginSubmitBtn" style="width: 100%; justify-content: center;">
                    <span id="loginBtnText">Se connecter / S'inscrire</span>
                    <div id="loginSpinner" class="spinner" style="display: none;"></div>
                </button>
            </form>
            <p class="modal-note">üîê Pas de mot de passe requis ! Votre pseudo et email suffisent.</p>
        </div>
    </div>

    <section id="home" class="page active">
        <header class="main-header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">FOCUS ISEP</div>
                    <nav class="nav-links">
                        <a href="#home" class="nav-link active">Accueil</a>
                        <a href="#proba-tds" class="nav-link">TDs Proba</a>
                        <a href="#telecom-rev" class="nav-link">R√©vision T√©l√©com</a>
                        <a href="#about" class="nav-link">√Ä Propos</a>
                        <a href="#faq" class="nav-link">FAQ</a>
                    </nav>
                    <div id="userSection" class="user-section">
                        <button id="loginBtn" class="login-btn">
                            <i class="fas fa-user"></i> Se connecter
                        </button>
                        <div id="userInfo" class="user-info" style="display: none;">
                            <span id="userGreeting">Bonjour, </span>
                            <button id="logoutBtn" class="logout-btn">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <section class="hero-section">
            <div class="container">
                <div class="hero-content">
                    <div>
                        <span class="tagline">OPTIMISEZ VOTRE R√âVISION</span>
                        <h1 class="hero-title">Ma√Ætriser les Probabilit√©s et les R√©seaux avec Pr√©cision</h1>
                        <p class="hero-description">Acc√©dez √† des fiches de r√©vision structur√©es, des exercices corrig√©s pas √† pas, et un r√©sum√© complet des concepts cl√©s en T√©l√©communications pour une pr√©paration cibl√©e et efficace.</p>
                        <div class="hero-actions">
                            <a href="#proba-tds" class="cta-button">Commencer les TDs Proba ‚Üí</a>
                            <a href="#newsletter" class="cta-button secondary">Recevoir des fiches gratuites</a>
                        </div>
                    </div>
                    <div class="hero-image">
                        <div class="hero-image-placeholder">
                            <i class="fas fa-graduation-cap" style="font-size: 4rem;"></i>
                        </div>
                    </div>
                </div>
                
                <div class="trust-badges">
                    <div class="trust-badge">
                        <i class="fas fa-shield-alt"></i>
                        <span>Donn√©es 100% s√©curis√©es</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-user-shield"></i>
                        <span>Respect de votre vie priv√©e</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Projet √©tudiant collaboratif</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-euro-sign"></i>
                        <span>Totalement gratuit</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="stats-bar">
            <div class="container">
                <div class="stats-container">
                    <div class="stat-item">
                        <p class="stat-number" id="totalUsers">0</p>
                        <p class="stat-label">√âtudiants inscrits</p>
                    </div>
                    <div class="stat-item">
                        <p class="stat-number">5</p>
                        <p class="stat-label">TDs de Proba</p>
                    </div>
                    <div class="stat-item">
                        <p class="stat-number">1</p>
                        <p class="stat-label">Fiche T√©l√©com Compl√®te</p>
                    </div>
                    <div class="stat-item">
                        <p class="stat-number">100%</p>
                        <p class="stat-label">Contenu Cible</p>
                    </div>
                </div>
            </div>
        </section>

        <div class="container">
            <hr class="separator">

            <section id="proba-tds" class="section">
                <h2 class="section-title">Modules de Travaux Dirig√©s (TD) - Probabilit√©s</h2>
                <p class="section-description">Cliquez sur un module pour acc√©der √† la fiche de r√©vision compl√®te et aux exercices corrig√©s.</p>
                
                <div id="progressIndicator" class="progress-indicator">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <span id="progressText">Votre progression: 0/5 TDs compl√©t√©s</span>
                </div>
                
                <div class="td-grid">
                    <div class="td-card" data-td="1">
                        <div class="card-header">
                            <h3>TD1</h3>
                            <span class="difficulty easy">Facile</span>
                        </div>
                        <p>Probabilit√©s Conditionnelles & Ind√©pendance</p>
                        <div class="card-footer">
                            <span class="time-estimate"><i class="far fa-clock"></i> ~1.5h</span>
                        </div>
                    </div>
                    <div class="td-card" data-td="2">
                        <div class="card-header">
                            <h3>TD2</h3>
                            <span class="difficulty medium">Moyen</span>
                        </div>
                        <p>Variables Al√©atoires Discr√®tes : Binomiale, Poisson...</p>
                        <div class="card-footer">
                            <span class="time-estimate"><i class="far fa-clock"></i> ~2h</span>
                        </div>
                    </div>
                    <div class="td-card" data-td="3">
                        <div class="card-header">
                            <h3>TD3</h3>
                            <span class="difficulty medium">Moyen</span>
                        </div>
                        <p>Variables Al√©atoires Continues & Loi Normale</p>
                        <div class="card-footer">
                            <span class="time-estimate"><i class="far fa-clock"></i> ~2h</span>
                        </div>
                    </div>
                    <div class="td-card" data-td="4">
                        <div class="card-header">
                            <h3>TD4</h3>
                            <span class="difficulty hard">Difficile</span>
                        </div>
                        <p>Couples de Variables Al√©atoires : Loi Jointe & Marginales</p>
                        <div class="card-footer">
                            <span class="time-estimate"><i class="far fa-clock"></i> ~2.5h</span>
                        </div>
                    </div>
                    <div class="td-card" data-td="5">
                        <div class="card-header">
                            <h3>TD5</h3>
                            <span class="difficulty hard">Difficile</span>
                        </div>
                        <p>Vecteurs Gaussiens & Covariance</p>
                        <div class="card-footer">
                            <span class="time-estimate"><i class="far fa-clock"></i> ~3h</span>
                        </div>
                    </div>
                    <div class="td-card locked-card">
                        <div class="card-header">
                            <h3>TD6</h3>
                            <span class="difficulty">√Ä venir</span>
                        </div>
                        <p>Estimation et Th√©or√®mes Limites (√Ä venir)</p>
                        <div class="card-footer">
                            <span class="locked-badge"><i class="fas fa-lock"></i> Bient√¥t disponible</span>
                        </div>
                    </div>
                </div>
            </section>

            <hr class="separator">

            <section id="telecom-rev" class="section">
                <h2 class="section-title">R√©vision Compl√®te - T√©l√©communications</h2>
                <p class="section-description">Synth√®se ultra-d√©taill√©e des concepts cl√©s : Bilan de Liaison (PIRE, $P_r$), Th√©or√®me de Shannon, SINR, Affaiblissement (LTE, Wi-Fi, Fibre).</p>
                
                <div class="telecom-features">
                    <div class="feature">
                        <i class="fas fa-chart-line"></i>
                        <h4>Bilan de Liaison</h4>
                        <p>Comprenez PIRE, puissance re√ßue et calculs d'affaiblissement</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-bolt"></i>
                        <h4>Th√©or√®me de Shannon</h4>
                        <p>Ma√Ætrisez la capacit√© maximale d'un canal de communication</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-wifi"></i>
                        <h4>Technologies R√©seau</h4>
                        <p>LTE, Wi-Fi, Fibre optique et leurs sp√©cificit√©s</p>
                    </div>
                </div>
                
                <a href="telecom.html" class="cta-button secondary-cta">Acc√©der √† la Fiche T√©l√©com Compl√®te ‚Üí</a>
            </section>

            <hr class="separator">

            <section id="temoignages" class="section">
                <h2 class="section-title">Ce que disent nos √©tudiants</h2>
                <div class="testimonials">
                    <div class="testimonial">
                        <div class="testimonial-content">
                            <p>"Gr√¢ce √† ces fiches, j'ai enfin compris les probabilit√©s conditionnelles qui me posaient probl√®me depuis des mois. Les explications pas √† pas sont incroyablement claires."</p>
                        </div>
                        <div class="testimonial-author">
                            <strong>Marie L.</strong>
                            <span>√âtudiante en 2√®me ann√©e</span>
                        </div>
                    </div>
                    <div class="testimonial">
                        <div class="testimonial-content">
                            <p>"La fiche t√©l√©com m'a sauv√© pour mon partiel. Tout est synth√©tis√© de mani√®re logique avec des exemples concrets. Je recommande √† 100%!"</p>
                        </div>
                        <div class="testimonial-author">
                            <strong>Thomas D.</strong>
                            <span>√âtudiant en 3√®me ann√©e</span>
                        </div>
                    </div>
                    <div class="testimonial">
                        <div class="testimonial-content">
                            <p>"Le syst√®me de progression m'a motiv√© √† terminer tous les TDs. J'ai am√©lior√© ma moyenne de 2 points en probabilit√©s!"</p>
                        </div>
                        <div class="testimonial-author">
                            <strong>Alexandre P.</strong>
                            <span>√âtudiant en 2√®me ann√©e</span>
                        </div>
                    </div>
                </div>
            </section>

            <hr class="separator">

            <section id="newsletter" class="newsletter-section">
                <div class="container">
                    <div class="newsletter-content">
                        <h2>Recevez des fiches de r√©vision gratuites</h2>
                        <p>Inscrivez-vous pour recevoir des r√©sum√©s de cours, des exercices suppl√©mentaires et des astuces de r√©vision directement dans votre bo√Æte mail.</p>
                        
                        <div id="newsletterFormContainer">
                            <form id="newsletterForm" class="newsletter-form">
                                <input type="email" id="newsletterEmail" placeholder="Votre adresse email" required>
                                <button type="submit" class="cta-button">S'inscrire √† la newsletter</button>
                            </form>
                        </div>
                        
                        <div id="newsletterStatus" style="display: none;"></div>
                        <p class="privacy-note">Nous respectons votre vie priv√©e. D√©sabonnez-vous √† tout moment.</p>
                    </div>
                </div>
            </section>
        </div>
        
        <footer class="main-footer">
            <div class="container">
                <div class="footer-content">
                    <div>
                        <h4>Focus ISEP</h4>
                        <p style="color: #adb5bd; margin-bottom: 20px;">Plateforme collaborative d'entraide √©tudiante pour la r√©ussite acad√©mique √† l'ISEP.</p>
                        <div class="trust-badge" style="background: rgba(255,255,255,0.1); margin: 0;">
                            <i class="fas fa-heart"></i>
                            <span>Fait avec passion par des √©tudiants</span>
                        </div>
                    </div>
                    
                    <div>
                        <h4>Ressources</h4>
                        <ul class="footer-links">
                            <li><a href="#proba-tds">TDs Probabilit√©s</a></li>
                            <li><a href="#telecom-rev">R√©vision T√©l√©com</a></li>
                            <li><a href="#newsletter">Newsletter</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4>Aide</h4>
                        <ul class="footer-links">
                            <li><a href="#faq">FAQ</a></li>
                            <li><a href="#about">√Ä Propos</a></li>
                            <li><a href="mailto:contact@focus-isep.fr">Contact</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4>L√©gal</h4>
                        <ul class="footer-links">
                            <li><a href="#cgu">Conditions d'utilisation</a></li>
                            <li><a href="#privacy">Confidentialit√©</a></li>
                            <li><a href="#cgu">Mentions l√©gales</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p>&copy; 2025 Focus ISEP R√©visions. Projet √©tudiant collaboratif - Seydi </p>
                    <div class="legal-links">
                        <a href="#privacy">Politique de confidentialit√©</a>
                        <a href="#cgu">Conditions g√©n√©rales</a>
                        <a href="#about">√Ä propos</a>
                        <a href="#faq">FAQ</a>
                    </div>
                </div>
            </div>
        </footer>
    </section>

    <!-- Pages l√©gales -->
    <div id="legalPages" style="display: none;">
        <!-- √Ä Propos -->
        <div id="aboutPage" class="legal-content">
            <h1>√Ä Propos de Focus ISEP</h1>
            
            <div class="highlight-box">
                <h3>üéØ Notre Mission</h3>
                <p>Focus ISEP est une plateforme collaborative cr√©√©e par et pour les √©tudiants de l'ISEP, dans le but de mutualiser les ressources et faciliter la r√©ussite acad√©mique.</p>
            </div>

            <h2>üìö Ce que nous proposons</h2>
            <ul>
                <li><strong>TDs de Probabilit√©s complets</strong> avec corrections d√©taill√©es</li>
                <li><strong>Fiches de r√©vision T√©l√©communications</strong> synth√©tiques</li>
                <li><strong>Suivi de progression personnel</strong> pour mesurer vos avanc√©es</li>
                <li><strong>Contenu 100% cibl√© ISEP</strong> adapt√© √† votre cursus</li>
            </ul>

            <h2>üîí Notre engagement</h2>
            <p>Nous nous engageons √† :</p>
            <ul>
                <li>‚úÖ <strong>Respecter votre vie priv√©e</strong> - Vos donn√©es ne seront jamais vendues ou partag√©es</li>
                <li>‚úÖ <strong>Utiliser vos donn√©es uniquement</strong> pour am√©liorer votre exp√©rience d'apprentissage</li>
                <li>‚úÖ <strong>Maintenir la gratuit√©</strong> de l'acc√®s aux ressources p√©dagogiques</li>
                <li>‚úÖ <strong>Fournir un contenu de qualit√©</strong> v√©rifi√© par des √©tudiants avanc√©s</li>
            </ul>

            <h2>üë• Qui sommes-nous ?</h2>
            <p>Focus ISEP est un projet √©tudiant ind√©pendant, d√©velopp√© par Seydi et d'autres √©tudiants motiv√©s de l'ISEP. Notre objectif est simple : s'entraider pour r√©ussir ensemble !</p>

            <div class="highlight-box">
                <h3>üí° Philosophie</h3>
                <p>"La connaissance n'a de valeur que lorsqu'elle est partag√©e. Focus ISEP incarne cette vision en cr√©ant une communaut√© d'entraide √©tudiante solidaire et efficace."</p>
            </div>
            
            <button onclick="LegalPagesManager.hideAll()" class="cta-button" style="margin-top: 30px;">Retour √† l'accueil</button>
        </div>

        <!-- FAQ -->
        <div id="faqPage" class="legal-content">
            <h1>Foire Aux Questions</h1>

            <h2>ü§î Questions G√©n√©rales</h2>

            <h3>Q: Focus ISEP est-il vraiment gratuit ?</h3>
            <p><strong>R:</strong> Oui, absolument ! L'acc√®s √† toutes les ressources est et restera gratuit. C'est un projet √©tudiant collaboratif, pas une entreprise commerciale.</p>

            <h3>Q: Puis-je contribuer au projet ?</h3>
            <p><strong>R:</strong> Bien s√ªr ! Si vous avez des fiches, des corrections ou des ressources √† partager, contactez-nous. La force de Focus ISEP, c'est la communaut√© !</p>

            <h2>üîê S√©curit√© et Donn√©es</h2>

            <h3>Q: Que faites-vous de mes donn√©es ?</h3>
            <p><strong>R:</strong> Nous stockons uniquement :
                <ul>
                    <li>Votre pseudo et email pour votre compte</li>
                    <li>Votre progression dans les TDs pour votre suivi personnel</li>
                    <li>Vos pr√©f√©rences de newsletter (si abonn√©)</li>
                </ul>
                <strong>Nous ne vendons, ne partageons ni n'utilisons vos donn√©es √† des fins commerciales.</strong>
            </p>

            <h3>Q: Mes donn√©es sont-elles s√©curis√©es ?</h3>
            <p><strong>R:</strong> Oui, nous utilisons Supabase avec un chiffrement de niveau entreprise. Vos donn√©es sont stock√©es en France et prot√©g√©es par le RGPD.</p>

            <h3>Q: Puis-je supprimer mon compte ?</h3>
            <p><strong>R:</strong> Oui, envoyez simplement un email √† contact@focus-isep.fr avec votre demande. Toutes vos donn√©es seront supprim√©es sous 48h.</p>

            <h2>üìñ Utilisation de la Plateforme</h2>

            <h3>Q: Comment sont cr√©√©es les corrections ?</h3>
            <p><strong>R:</strong> Toutes les corrections sont r√©alis√©es par des √©tudiants ayant valid√© les mati√®res concern√©es, puis v√©rifi√©es par d'autres √©tudiants et parfois par des anciens.</p>

            <h3>Q: Puis-je sugg√©rer de nouvelles fonctionnalit√©s ?</h3>
            <p><strong>R:</strong> Absolument ! Nous sommes toujours √† l'√©coute de vos suggestions pour am√©liorer la plateforme.</p>

            <h3>Q: Le contenu est-il officiellement approuv√© par l'ISEP ?</h3>
            <p><strong>R:</strong> Non, Focus ISEP est une initiative √©tudiante ind√©pendante. Le contenu est cr√©√© par des √©tudiants pour des √©tudiants.</p>
            
            <button onclick="LegalPagesManager.hideAll()" class="cta-button" style="margin-top: 30px;">Retour √† l'accueil</button>
        </div>

        <!-- CGU -->
        <div id="cguPage" class="legal-content">
            <h1>Conditions G√©n√©rales d'Utilisation</h1>
            <p><em>Derni√®re mise √† jour : 2025</em></p>

            <div class="highlight-box">
                <h3>‚ö†Ô∏è Attention</h3>
                <p>Focus ISEP est un <strong>projet √©tudiant collaboratif et gratuit</strong>. En utilisant cette plateforme, vous acceptez ces conditions simples et transparentes.</p>
            </div>

            <h2>1. Acceptation des Conditions</h2>
            <p>L'utilisation de Focus ISEP implique l'acceptation pleine et enti√®re des pr√©sentes conditions d'utilisation.</p>

            <h2>2. Description du Service</h2>
            <p>Focus ISEP met √† disposition :</p>
            <ul>
                <li>Des ressources p√©dagogiques pour les √©tudiants de l'ISEP</li>
                <li>Un syst√®me de suivi de progression personnel</li>
                <li>Une newsletter optionnelle avec du contenu √©ducatif</li>
            </ul>

            <h2>3. Compte Utilisateur</h2>
            <p>La cr√©ation d'un compte n√©cessite :</p>
            <ul>
                <li>Un pseudo unique (minimum 3 caract√®res)</li>
                <li>Une adresse email valide</li>
                <li>L'acceptation de notre politique de confidentialit√©</li>
            </ul>

            <h2>4. Utilisation Acceptable</h2>
            <p>Vous vous engagez √† :</p>
            <ul>
                <li>Utiliser la plateforme √† des fins √©ducatives uniquement</li>
                <li>Ne pas tenter de perturber le service</li>
                <li>Respecter les autres utilisateurs</li>
                <li>Ne pas copier massivement le contenu sans citation</li>
            </ul>

            <h2>5. Propri√©t√© Intellectuelle</h2>
            <p>Le contenu p√©dagogique est sous licence Creative Commons BY-NC-SA :</p>
            <ul>
                <li>‚úÖ Vous pouvez le partager et l'adapter</li>
                <li>‚úÖ Vous devez citer Focus ISEP</li>
                <li>‚ùå Utilisation commerciale interdite</li>
                <li>‚úÖ M√™mes conditions pour les adaptations</li>
            </ul>

            <h2>6. Limitation de Responsabilit√©</h2>
            <p>Focus ISEP est un service gratuit fourni "tel quel". Nous ne garantissons pas :</p>
            <ul>
                <li>L'exactitude absolue de tous les contenus</li>
                <li>La disponibilit√© permanente du service</li>
                <li>La r√©ussite aux examens (√ßa d√©pend de votre travail !)</li>
            </ul>

            <h2>7. Modification des Conditions</h2>
            <p>Nous nous engageons √† :</p>
            <ul>
                <li>Vous informer des modifications importantes</li>
                <li>Consulter la communaut√© pour les changements majeurs</li>
                <li>Garder l'esprit collaboratif et transparent</li>
            </ul>

            <h2>8. Contact</h2>
            <p>Pour toute question : <strong>contact@focus-isep.fr</strong></p>
            
            <button onclick="LegalPagesManager.hideAll()" class="cta-button" style="margin-top: 30px;">Retour √† l'accueil</button>
        </div>

        <!-- Politique de Confidentialit√© -->
        <div id="privacyPage" class="legal-content">
            <h1>Politique de Confidentialit√©</h1>
            <p><em>Vos donn√©es sont en s√©curit√© avec nous</em></p>

            <div class="highlight-box">
                <h3>üîí Notre Promesse</h3>
                <p>Nous ne vendons, ne partageons ni n'utilisons vos donn√©es √† des fins commerciales. Vos informations servent uniquement √† am√©liorer votre exp√©rience d'apprentissage.</p>
            </div>

            <h2>1. Donn√©es Collect√©es</h2>
            <p>Nous collectons le strict n√©cessaire :</p>
            <ul>
                <li><strong>Donn√©es de compte :</strong> Pseudo, email, date d'inscription</li>
                <li><strong>Progression :</strong> TDs compl√©t√©s, scores, temps pass√©</li>
                <li><strong>Newsletter :</strong> Pr√©f√©rences d'abonnement (optionnel)</li>
                <li><strong>Techniques :</strong> Adresse IP, navigateur (pour la s√©curit√©)</li>
            </ul>

            <h2>2. Utilisation des Donn√©es</h2>
            <p>Vos donn√©es servent uniquement √† :</p>
            <ul>
                <li>‚úÖ Vous connecter √† votre compte</li>
                <li>‚úÖ Sauvegarder votre progression</li>
                <li>‚úÖ Vous envoyer des notifications de progression</li>
                <li>‚úÖ Vous envoyer la newsletter (si abonn√©)</li>
                <li>‚úÖ Am√©liorer la plateforme (statistiques anonymes)</li>
            </ul>

            <p><strong>Ce que nous ne faisons PAS :</strong></p>
            <ul>
                <li>‚ùå Vendre ou louer vos donn√©es</li>
                <li>‚ùå Partager avec des tiers commerciaux</li>
                <li>‚ùå Utiliser pour du marketing externe</li>
                <li>‚ùå Analyser votre comportement √† des fins commerciales</li>
            </ul>

            <h2>3. Protection des Donn√©es</h2>
            <p>Nous utilisons :</p>
            <ul>
                <li>Supabase (h√©bergement s√©curis√© en UE)</li>
                <li>Chiffrement des donn√©es en transit et au repos</li>
                <li>Authentification s√©curis√©e</li>
                <li>Sauvegardes r√©guli√®res</li>
            </ul>

            <h2>4. Vos Droits</h2>
            <p>Conform√©ment au RGPD, vous avez droit √† :</p>
            <ul>
                <li>üìã Acc√®s √† vos donn√©es personnelles</li>
                <li>‚úèÔ∏è Rectification des donn√©es inexactes</li>
                <li>üóëÔ∏è Suppression de votre compte et donn√©es</li>
                <li>üì§ Portabilit√© de vos donn√©es</li>
                <li>üö´ Opposition au traitement</li>
            </ul>

            <h2>5. Conservation des Donn√©es</h2>
            <p>Nous conservons vos donn√©es :</p>
            <ul>
                <li>Compte actif : Tant que vous utilisez la plateforme</li>
                <li>Compte inactif : 2 ans puis suppression</li>
                <li>Donn√©es de progression : Conserv√©es avec votre compte</li>
            </ul>

            <h2>6. Cookies</h2>
            <p>Nous utilisons uniquement des cookies techniques essentiels :</p>
            <ul>
                <li>Session de connexion</li>
                <li>Pr√©f√©rences d'interface</li>
                <li>Aucun cookie de tracking publicitaire</li>
            </ul>

            <h2>7. Contact DPO</h2>
            <p>Pour exercer vos droits : <strong>privacy@focus-isep.fr</strong></p>
            <p>Nous nous engageons √† r√©pondre sous 72h.</p>
            
            <button onclick="LegalPagesManager.hideAll()" class="cta-button" style="margin-top: 30px;">Retour √† l'accueil</button>
        </div>
    </div>

    <script>
        // Configuration Supabase
        const SUPABASE_URL = 'https://eznzfgcwbqcckkvhsdhi.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_6WhkWn3e1Gdy8DTnkLmjMA_O10roVtv';
        
        // Initialisation Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // Gestion de l'√©tat utilisateur
        let currentUser = null;
        let userProgress = {};

        // Gestion des pages l√©gales
        class LegalPagesManager {
            static showPage(pageId) {
                // Cacher la page principale
                document.getElementById('home').style.display = 'none';
                
                // Afficher la page l√©gale demand√©e
                const page = document.getElementById(pageId);
                if (page) {
                    page.style.display = 'block';
                    document.getElementById('legalPages').style.display = 'block';
                    
                    // Scroll vers le haut
                    window.scrollTo(0, 0);
                }
            }
            
            static hideAll() {
                document.getElementById('legalPages').style.display = 'none';
                document.getElementById('home').style.display = 'block';
                
                // Cacher toutes les pages l√©gales
                document.querySelectorAll('#legalPages > div').forEach(page => {
                    page.style.display = 'none';
                });
            }
        }

        // Gestion de l'authentification
        class AuthManager {
            constructor() {
                this.currentUser = null;
                this.init();
            }

            async init() {
                console.log('üîß Initialisation AuthManager avec Supabase...');
                
                // V√©rifier si l'utilisateur est d√©j√† connect√©
                const savedUser = localStorage.getItem('focusUser');
                if (savedUser) {
                    try {
                        this.currentUser = JSON.parse(savedUser);
                        this.updateUI();
                        await this.loadUserProgress();
                        await this.updateStats();
                    } catch (e) {
                        console.error('Erreur parsing saved user:', e);
                        localStorage.removeItem('focusUser');
                    }
                }
                
                await this.updateStats();
            }

            async login(username, email) {
                const submitBtn = document.getElementById('loginSubmitBtn');
                const btnText = document.getElementById('loginBtnText');
                const spinner = document.getElementById('loginSpinner');
                
                // Afficher le spinner
                btnText.textContent = 'Connexion...';
                spinner.style.display = 'inline-block';
                submitBtn.disabled = true;

                try {
                    console.log('üîê Tentative de connexion:', { username, email });

                    // V√©rifier d'abord si l'utilisateur existe
                    const { data: existingUser, error: checkError } = await supabase
                        .from('users')
                        .select('*')
                        .or(`username.eq.${username},email.eq.${email}`)
                        .maybeSingle();

                    let user;
                    
                    if (existingUser) {
                        // Utilisateur existant
                        console.log('üë§ Utilisateur existant trouv√©');
                        user = existingUser;
                        
                        // Mettre √† jour last_login
                        const { error: updateError } = await supabase
                            .from('users')
                            .update({ last_login: new Date().toISOString() })
                            .eq('id', user.id);
                            
                        if (updateError) {
                            console.warn('‚ö†Ô∏è Erreur mise √† jour last_login:', updateError);
                        }
                    } else {
                        // Nouvel utilisateur - cr√©ation
                        console.log('üÜï Cr√©ation nouvel utilisateur');
                        const { data: newUser, error: insertError } = await supabase
                            .from('users')
                            .insert([{ 
                                username, 
                                email,
                                created_at: new Date().toISOString(),
                                last_login: new Date().toISOString()
                            }])
                            .select()
                            .single();
                        
                        if (insertError) {
                            console.error('‚ùå Erreur cr√©ation utilisateur:', insertError);
                            throw insertError;
                        }
                        user = newUser;
                        console.log('‚úÖ Nouvel utilisateur cr√©√©:', user);
                    }

                    this.currentUser = user;
                    localStorage.setItem('focusUser', JSON.stringify(user));
                    this.updateUI();
                    await this.loadUserProgress();
                    await this.updateStats();
                    
                    return { success: true, user };
                    
                } catch (error) {
                    console.error('‚ùå Erreur de connexion:', error);
                    
                    let errorMessage = 'Erreur de connexion';
                    
                    if (error.code === '23505') {
                        errorMessage = 'Ce pseudo ou email est d√©j√† utilis√©';
                    } else if (error.message.includes('JWT')) {
                        errorMessage = 'Erreur de configuration Supabase';
                    } else if (error.message.includes('relation "users" does not exist')) {
                        errorMessage = 'Base de donn√©es non configur√©e. Contactez l\'administrateur.';
                    } else {
                        errorMessage = error.message || 'Erreur inconnue';
                    }
                    
                    return { success: false, error: errorMessage };
                } finally {
                    btnText.textContent = 'Se connecter / S\'inscrire';
                    spinner.style.display = 'none';
                    submitBtn.disabled = false;
                }
            }

            logout() {
                this.currentUser = null;
                localStorage.removeItem('focusUser');
                this.updateUI();
                userProgress = {};
                this.updateProgressUI();
                this.updateStats();
                showNotification('üëã D√©connexion r√©ussie', 'info');
            }

            updateUI() {
                const loginBtn = document.getElementById('loginBtn');
                const userInfo = document.getElementById('userInfo');
                const userGreeting = document.getElementById('userGreeting');
                const progressIndicator = document.getElementById('progressIndicator');

                if (this.currentUser) {
                    loginBtn.style.display = 'none';
                    userInfo.style.display = 'flex';
                    userGreeting.textContent = `Bonjour, ${this.currentUser.username}`;
                    if (progressIndicator) progressIndicator.style.display = 'block';
                } else {
                    loginBtn.style.display = 'block';
                    userInfo.style.display = 'none';
                    if (progressIndicator) progressIndicator.style.display = 'none';
                }
            }

            async loadUserProgress() {
                if (!this.currentUser) return;

                try {
                    console.log('üìä Chargement progression pour:', this.currentUser.id);
                    const { data, error } = await supabase
                        .from('td_progress')
                        .select('*')
                        .eq('user_id', this.currentUser.id);

                    if (error) {
                        if (error.message.includes('relation "td_progress" does not exist')) {
                            console.warn('‚ö†Ô∏è Table td_progress non trouv√©e');
                            return;
                        }
                        throw error;
                    }

                    userProgress = {};
                    if (data) {
                        data.forEach(progress => {
                            userProgress[progress.td_number] = progress;
                        });
                    }

                    console.log('‚úÖ Progression charg√©e:', userProgress);
                    this.updateProgressUI();
                    this.updateTDCards();
                    
                } catch (error) {
                    console.error('‚ùå Erreur chargement progression:', error);
                }
            }

            updateProgressUI() {
                if (!this.currentUser) return;

                const completedTDs = Object.values(userProgress).filter(p => p.is_completed).length;
                const totalTDs = 5;
                const progressPercent = (completedTDs / totalTDs) * 100;

                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');
                
                if (progressFill && progressText) {
                    progressFill.style.width = `${progressPercent}%`;
                    progressText.textContent = `Votre progression: ${completedTDs}/${totalTDs} TDs compl√©t√©s`;
                }
            }

            updateTDCards() {
                const tdCards = document.querySelectorAll('.td-card:not(.locked-card)');
                
                tdCards.forEach(card => {
                    const tdNumber = parseInt(card.getAttribute('data-td'));
                    if (!tdNumber) return;
                    
                    const progress = userProgress[tdNumber];
                    
                    if (progress && progress.is_completed) {
                        card.classList.add('completed');
                        let footer = card.querySelector('.card-footer');
                        if (!footer) {
                            footer = document.createElement('div');
                            footer.className = 'card-footer';
                            card.appendChild(footer);
                        }
                        footer.innerHTML = `<span class="completion-badge"><i class="fas fa-check"></i> Compl√©t√©</span>`;
                    }
                });
            }

            async updateStats() {
                try {
                    const { count, error } = await supabase
                        .from('users')
                        .select('*', { count: 'exact', head: true });

                    if (error) {
                        if (error.message.includes('relation "users" does not exist')) {
                            console.warn('‚ö†Ô∏è Table users non trouv√©e pour les stats');
                            return;
                        }
                        throw error;
                    }

                    if (!error && count !== null) {
                        const totalUsersElement = document.getElementById('totalUsers');
                        if (totalUsersElement) {
                            totalUsersElement.textContent = count;
                        }
                    }
                } catch (error) {
                    console.error('‚ùå Erreur mise √† jour stats:', error);
                }
            }

            isLoggedIn() {
                return this.currentUser !== null;
            }
        }

        // Gestion de la progression
        class ProgressManager {
            static async markTDCompleted(tdNumber, score = null, timeSpent = null) {
                if (!authManager.currentUser) {
                    showNotification('üîê Veuillez vous connecter pour enregistrer votre progression.', 'info');
                    return false;
                }

                try {
                    const progressData = {
                        user_id: authManager.currentUser.id,
                        td_number: tdNumber,
                        is_completed: true,
                        completed_at: new Date().toISOString(),
                        score: score,
                        time_spent: timeSpent,
                        last_accessed: new Date().toISOString()
                    };

                    console.log('üíæ Sauvegarde progression:', progressData);

                    const { data, error } = await supabase
                        .from('td_progress')
                        .upsert(progressData, { onConflict: 'user_id,td_number' })
                        .select()
                        .single();

                    if (error) throw error;

                    userProgress[tdNumber] = data;
                    authManager.updateProgressUI();
                    authManager.updateTDCards();
                    
                    showNotification('‚úÖ Progression sauvegard√©e !', 'success');
                    return true;
                    
                } catch (error) {
                    console.error('‚ùå Erreur sauvegarde progression:', error);
                    showNotification('‚ùå Erreur sauvegarde progression', 'error');
                    return false;
                }
            }

            static async updateLastAccessed(tdNumber) {
                if (!authManager.currentUser) return;

                try {
                    await supabase
                        .from('td_progress')
                        .upsert({
                            user_id: authManager.currentUser.id,
                            td_number: tdNumber,
                            last_accessed: new Date().toISOString()
                        }, { onConflict: 'user_id,td_number' });
                        
                } catch (error) {
                    console.error('‚ùå Erreur mise √† jour acc√®s:', error);
                }
            }
        }

        // Gestion newsletter
        class NewsletterManager {
            static async subscribe(email, userId = null) {
                try {
                    const { data: existing, error: checkError } = await supabase
                        .from('newsletter_subscriptions')
                        .select('*')
                        .eq('email', email)
                        .eq('is_active', true)
                        .single();

                    if (existing) {
                        return { success: false, error: 'Vous √™tes d√©j√† inscrit √† la newsletter' };
                    }

                    const subscriptionData = {
                        email: email,
                        user_id: userId,
                        subscribed_at: new Date().toISOString(),
                        is_active: true
                    };

                    console.log('üìß Inscription newsletter:', subscriptionData);

                    const { data, error } = await supabase
                        .from('newsletter_subscriptions')
                        .insert([subscriptionData])
                        .select()
                        .single();

                    if (error) throw error;
                    
                    console.log('‚úÖ Inscription newsletter r√©ussie');
                    return { success: true, data };
                    
                } catch (error) {
                    console.error('‚ùå Erreur inscription newsletter:', error);
                    return { success: false, error: error.message };
                }
            }
        }

        // Initialisation
        const authManager = new AuthManager();

        // Fonction utilitaire pour les notifications
        function showNotification(message, type = 'info') {
            // Supprimer les notifications existantes
            document.querySelectorAll('.notification').forEach(n => n.remove());

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-message">${message}</span>
                    <button class="notification-close">&times;</button>
                </div>
            `;

            // Appliquer les styles
            Object.assign(notification.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                padding: '0',
                borderRadius: '8px',
                zIndex: '10000',
                boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
                maxWidth: '400px',
                animation: 'slideInRight 0.3s ease'
            });

            // Couleurs selon le type
            const colors = {
                success: { bg: '#4CAF50', text: '#fff' },
                error: { bg: '#f44336', text: '#fff' },
                info: { bg: '#2196F3', text: '#fff' }
            };

            const color = colors[type] || colors.info;
            notification.style.background = color.bg;
            notification.style.color = color.text;

            document.body.appendChild(notification);

            // Bouton de fermeture
            notification.querySelector('.notification-close').addEventListener('click', function() {
                notification.remove();
            });

            // Fermeture automatique
            setTimeout(function() {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOutRight 0.3s ease';
                    setTimeout(function() {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 4000);
        }

        // √âv√©nements DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initialisation de Focus ISEP...');

            // Modal de connexion
            const loginModal = document.getElementById('loginModal');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const closeModal = document.querySelector('.close-modal');
            const loginForm = document.getElementById('loginForm');

            // Gestion du modal de connexion
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('üéØ Bouton connexion cliqu√©');
                    loginModal.style.display = 'block';
                });
            }

            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    authManager.logout();
                });
            }
            
            if (closeModal) {
                closeModal.addEventListener('click', function() {
                    loginModal.style.display = 'none';
                });
            }

            // Fermer modal en cliquant √† l'ext√©rieur
            window.addEventListener('click', function(e) {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
            });

            // Connexion
            if (loginForm) {
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const username = document.getElementById('username').value.trim();
                    const email = document.getElementById('email').value.trim();

                    if (username.length < 3) {
                        showNotification('‚ùå Le pseudo doit faire au moins 3 caract√®res', 'error');
                        return;
                    }

                    const result = await authManager.login(username, email);
                    
                    if (result.success) {
                        loginModal.style.display = 'none';
                        loginForm.reset();
                        showNotification(`üéâ Bienvenue ${username} !`, 'success');
                    } else {
                        showNotification('‚ùå ' + result.error, 'error');
                    }
                });
            }

            // Newsletter
            const newsletterForm = document.getElementById('newsletterForm');
            if (newsletterForm) {
                newsletterForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const email = document.getElementById('newsletterEmail').value.trim();
                    
                    const result = await NewsletterManager.subscribe(email, authManager.currentUser?.id);
                    
                    if (result.success) {
                        showNotification('‚úÖ Inscription √† la newsletter r√©ussie !', 'success');
                        newsletterForm.reset();
                    } else {
                        showNotification('‚ùå ' + result.error, 'error');
                    }
                });
            }

            // Gestion des clics sur les TDs
            document.querySelectorAll('.td-card:not(.locked-card)').forEach(card => {
                card.addEventListener('click', async function(e) {
                    e.preventDefault();
                    const tdNumber = parseInt(this.getAttribute('data-td'));
                    console.log('üéØ Clic sur TD:', tdNumber);
                    
                    if (!authManager.isLoggedIn()) {
                        showNotification('üîê Veuillez vous connecter pour acc√©der aux TDs', 'info');
                        loginModal.style.display = 'block';
                        return;
                    }

                    // Mettre √† jour le dernier acc√®s
                    await ProgressManager.updateLastAccessed(tdNumber);
                    
                    // Rediriger vers la page du TD
                    const tdPages = {
                        1: 'td1.html',
                        2: 'td2.html',
                        3: 'td3.html',
                        4: 'td4.html',
                        5: 'td5.html'
                    };
                    
                    const tdPage = tdPages[tdNumber];
                    if (tdPage) {
                        console.log('üîó Redirection vers:', tdPage);
                        window.location.href = tdPage;
                    } else {
                        showNotification('‚ùå Page TD non trouv√©e', 'error');
                    }
                });
            });

            // Gestion des pages l√©gales
            document.querySelectorAll('a[href^="#"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    const target = this.getAttribute('href').substring(1);
                    
                    if (['about', 'faq', 'cgu', 'privacy'].includes(target)) {
                        e.preventDefault();
                        LegalPagesManager.showPage(target + 'Page');
                    }
                });
            });

            // Navigation smooth scroll
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    if (href === '#home' || href === '#proba-tds' || href === '#telecom-rev' || href === '#newsletter') {
                        e.preventDefault();
                        const target = document.querySelector(href);
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });

            console.log('‚úÖ Focus ISEP initialis√© avec succ√®s!');
        });

        // Animation CSS pour les notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            .notification-content {
                padding: 15px 20px;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            
            .notification-close {
                background: none;
                border: none;
                color: inherit;
                font-size: 1.2rem;
                cursor: pointer;
                margin-left: 15px;
            }
            
            .notification-message {
                flex: 1;
            }
            
            .spinner {
                display: inline-block;
                width: 16px;
                height: 16px;
                border: 2px solid #ffffff;
                border-radius: 50%;
                border-top-color: transparent;
                animation: spin 1s ease-in-out infinite;
                margin-left: 8px;
            }
            
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
