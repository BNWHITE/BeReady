<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDD - Entraînement Intensif</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* Styles spécifiques pour cette page (complémentaires au style.css existant) */
        body { background-color: #f4f6f8; color: #333; font-family: 'Segoe UI', sans-serif; }

        /* --- HEADER CLASSIQUE (Style Index/App) --- */
        .main-header {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky; top: 0; z-index: 1000;
            padding: 15px 0;
        }
        .header-content {
            max-width: 1200px; margin: 0 auto; padding: 0 20px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo { font-size: 1.5rem; font-weight: 800; color: #004E92; text-decoration: none; }
        .nav-links { display: flex; gap: 20px; }
        .nav-link { text-decoration: none; color: #555; font-weight: 600; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { color: #004E92; }

        /* --- CONTENU --- */
        .container { max-width: 1000px; margin: 40px auto; padding: 0 20px; }

        .section-title {
            text-align: center; margin-bottom: 40px;
            font-size: 2rem; color: #004E92;
        }
        
        /* ONGLETS */
        .tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .tab-btn {
            padding: 10px 25px; border: 1px solid #ddd; background: white;
            border-radius: 30px; cursor: pointer; font-weight: bold; color: #555;
            transition: 0.3s;
        }
        .tab-btn.active { background: #004E92; color: white; border-color: #004E92; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

        /* EXERCICES STYLE */
        .exo-block {
            background: white; border-radius: 8px; padding: 25px;
            margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-left: 5px solid #004E92;
        }
        
        .exo-title { font-size: 1.3rem; color: #2c3e50; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .badge { background: #f1c40f; color: #333; padding: 3px 10px; border-radius: 10px; font-size: 0.8rem; text-transform: uppercase; }
        
        .scenario-text {
            background: #f8f9fa; padding: 20px; border-radius: 5px;
            line-height: 1.8; text-align: justify; border: 1px solid #eee;
            margin-bottom: 20px; font-size: 1.05rem;
        }

        .btn-reveal {
            background: #004E92; color: white; border: none; padding: 12px 20px;
            border-radius: 5px; cursor: pointer; font-size: 1rem; font-weight: 600;
            width: 100%; text-align: center; transition: 0.3s;
        }
        .btn-reveal:hover { background: #003366; }

        .correction {
            margin-top: 20px; display: none; border-top: 2px dashed #ddd; padding-top: 20px;
        }

        /* TABLEAUX DE MAPPING */
        .db-schema {
            font-family: 'Consolas', monospace; background: #282c34; color: #abb2bf;
            padding: 20px; border-radius: 5px; overflow-x: auto;
        }
        .table-name { color: #e06c75; font-weight: bold; }
        .pk { color: #61afef; text-decoration: underline; }
        .fk { color: #98c379; font-style: italic; }
        .col { color: #abb2bf; }

        /* EXERCICE INVERSE */
        .reverse-exo .db-schema { margin-bottom: 20px; }
        .interpretation { background: #e8f6f3; color: #135946; padding: 15px; border-radius: 5px; border: 1px solid #a9dfbf; }

    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-content">
            <a href="index.html" class="logo">FOCUS ISEP</a>
            <nav class="nav-links">
                <a href="index.html" class="nav-link">Accueil</a>
                <a href="app_info.html" class="nav-link active">APP Info</a>
                <a href="app_elec.html" class="nav-link">APP Elec</a>
                <a href="app_signal.html" class="nav-link">APP Signal</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <h1 class="section-title">Entraînement BDD : Niveau Examen</h1>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('sens1')">1. Texte vers Tables (Classique)</button>
            <button class="tab-btn" onclick="openTab('sens2')">2. Tables vers Texte (Inverse)</button>
        </div>

        <div id="sens1" class="tab-content active">
            
            <div class="exo-block">
                <div class="exo-title">
                    <span>#1 Gestion des Vols Aériens</span>
                    <span class="badge">Complexe</span>
                </div>
                <div class="scenario-text">
                    <p>
                        On souhaite gérer les vols d'une agence de voyage. Plusieurs Compagnies aériennes (Air France, EasyJet...) proposent des vols. Une compagnie est identifiée par un code IATA et possède un nom. 
                        Un Vol est défini par un numéro unique, une heure de départ et une durée. Attention : un vol est opéré par une seule compagnie, mais part d'un Aéroport précis et arrive dans un autre Aéroport. Chaque aéroport a un trigramme (CDG, ORY), un nom et une superficie.
                    </p>
                    <p>
                        Il faut savoir que les aéroports desservent des Villes. Un aéroport peut desservir plusieurs villes (ex: Orly dessert Paris et Wissous) et une ville peut être desservie par plusieurs aéroports. Une ville a un nom et un nombre d'habitants.
                        Enfin, un vol peut comporter des Escales. Une escale se fait dans un aéroport donné, avec une heure d'arrivée et une heure de redépart. Un même vol peut avoir plusieurs escales, et un aéroport accueille plein d'escales.
                    </p>
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Voir le Mapping Relationnel</button>
                <div class="correction">
                    <div class="db-schema">
                        <span class="table-name">Compagnie</span> (<span class="pk">code_comp</span>, nom)<br>
                        <span class="table-name">Ville</span> (<span class="pk">id_ville</span>, nom, nb_habitants)<br>
                        <span class="table-name">Aeroport</span> (<span class="pk">trigramme</span>, nom, surface)<br>
                        <br>
                        <span class="table-name">Desservir</span> (<span class="pk fk">#trigramme</span>, <span class="pk fk">#id_ville</span>, distance_centre) <span class="col">// Table N:N</span><br>
                        <br>
                        <span class="table-name">Vol</span> (<span class="pk">num_vol</span>, heure_dep, duree, <span class="fk">#code_comp</span>, <span class="fk">#trigramme_depart</span>, <span class="fk">#trigramme_arrivee</span>)<br>
                        <br>
                        <span class="table-name">Escale</span> (<span class="pk fk">#num_vol</span>, <span class="pk fk">#trigramme_escale</span>, heure_arr, heure_redep) <span class="col">// Table N:N avec attributs</span>
                    </div>
                </div>
            </div>

            <div class="exo-block">
                <div class="exo-title">
                    <span>#2 Festival de Musique</span>
                    <span class="badge">N:N Multiple</span>
                </div>
                <div class="scenario-text">
                    <p>
                        Nous gérons un grand festival. Des groupes de musique viennent jouer. Un groupe a un nom, un style musical principal et une date de création. Chaque groupe est composé de plusieurs Membres (Musiciens). Un membre a un nom, un prénom et joue d'un Instrument. Attention, un membre peut jouer de plusieurs instruments, et un instrument est joué par pleins de membres. De plus, un musicien peut faire partie de plusieurs groupes (projets parallèles).
                    </p>
                    <p>
                        Les groupes se produisent lors de Concerts. Un concert a lieu à une date précise, dans une Salle spécifique du festival (Main Stage, Chapiteau...). Une salle a une capacité et un nom. Un concert peut voir défiler plusieurs groupes (une soirée à thème), et un groupe joue évidemment plusieurs concerts. Pour chaque participation d'un groupe à un concert, on veut noter l'heure de passage et la durée du set.
                    </p>
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Voir le Mapping Relationnel</button>
                <div class="correction">
                    <div class="db-schema">
                        <span class="table-name">Instrument</span> (<span class="pk">id_instru</span>, nom)<br>
                        <span class="table-name">Salle</span> (<span class="pk">id_salle</span>, nom, capacite)<br>
                        <span class="table-name">Membre</span> (<span class="pk">id_membre</span>, nom, prenom)<br>
                        <span class="table-name">Groupe</span> (<span class="pk">id_groupe</span>, nom, style, date_crea)<br>
                        <br>
                        <span class="table-name">Jouer_Instru</span> (<span class="pk fk">#id_membre</span>, <span class="pk fk">#id_instru</span>) <span class="col">// Qui joue de quoi</span><br>
                        <span class="table-name">Appartenir</span> (<span class="pk fk">#id_membre</span>, <span class="pk fk">#id_groupe</span>, role) <span class="col">// Qui est dans quel groupe</span><br>
                        <br>
                        <span class="table-name">Concert</span> (<span class="pk">id_concert</span>, date_event, <span class="fk">#id_salle</span>) <span class="col">// 1 Concert = 1 Salle</span><br>
                        <span class="table-name">Programmation</span> (<span class="pk fk">#id_concert</span>, <span class="pk fk">#id_groupe</span>, heure_passage, duree)
                    </div>
                </div>
            </div>

            <div class="exo-block">
                <div class="exo-title">
                    <span>#3 Clinique & Ordonnances</span>
                    <span class="badge">Ternaire Cachée</span>
                </div>
                <div class="scenario-text">
                    <p>
                        Une clinique souhaite numériser ses dossiers. Les Patients (SSN, Nom, Adresse) viennent consulter des Médecins (Matricule, Spécialité, Tarif).
                        Lors d'une consultation, le médecin rédige une Ordonnance unique. Cette ordonnance est datée. Sur une même ordonnance, le médecin peut prescrire plusieurs Médicaments. 
                    </p>
                    <p>
                        Un médicament est défini par un code barre et un libellé. Pour chaque médicament prescrit sur une ordonnance, on doit préciser la posologie (ex: "3 fois par jour") et la durée du traitement.
                        Par ailleurs, les patients sont hébergés dans des Chambres. Une chambre a un numéro et un étage. Un patient occupe une seule chambre à la fois, mais une chambre peut accueillir plusieurs patients (chambre double). On doit savoir depuis quelle date le patient est dans la chambre.
                    </p>
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Voir le Mapping Relationnel</button>
                <div class="correction">
                    <div class="db-schema">
                        <span class="table-name">Medicament</span> (<span class="pk">code_barre</span>, libelle)<br>
                        <span class="table-name">Chambre</span> (<span class="pk">num_chambre</span>, etage)<br>
                        <span class="table-name">Medecin</span> (<span class="pk">matricule</span>, specialite, tarif)<br>
                        <br>
                        <span class="table-name">Patient</span> (<span class="pk">ssn</span>, nom, adresse, <span class="fk">#num_chambre</span>, date_entree_chambre)<br>
                        <br>
                        <span class="table-name">Ordonnance</span> (<span class="pk">num_ordo</span>, date_ordo, <span class="fk">#matricule_medecin</span>, <span class="fk">#ssn_patient</span>)<br>
                        <span class="col">// Ordonnance lie Medecin et Patient (1,N chacun)</span><br>
                        <br>
                        <span class="table-name">Prescrire</span> (<span class="pk fk">#num_ordo</span>, <span class="pk fk">#code_barre</span>, posologie, duree)<br>
                        <span class="col">// Lien N:N entre Ordonnance et Medicament</span>
                    </div>
                </div>
            </div>

            <div class="exo-block">
                <div class="exo-title">
                    <span>#4 Amazon-Like (Logistique)</span>
                    <span class="badge">Gestion Stocks</span>
                </div>
                <div class="scenario-text">
                    <p>
                        Une plateforme de vente en ligne gère des Clients(id, email, solde). Les clients passent des Commandes. Une commande a une date, un statut et une adresse de livraison. Une commande contient plusieurs Produits. Pour chaque produit dans une commande, on note la quantité achetée et le prix au moment de l'achat (car le prix change !).
                    </p>
                    <p>
                        Les produits (ref, nom, description) sont stockés dans des Entrepôts. Un entrepôt a une localisation. Attention : un même produit peut être stocké dans plusieurs entrepôts différents (ex: iPhone à Paris et à Lyon), et on doit connaître la quantité de stock disponible pour ce produit dans chaque entrepôt.
                        Enfin, les produits sont fournis par des Fournisseurs. Un produit vient d'un seul fournisseur principal.
                    </p>
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Voir le Mapping Relationnel</button>
                <div class="correction">
                    <div class="db-schema">
                        <span class="table-name">Client</span> (<span class="pk">id_client</span>, email, solde)<br>
                        <span class="table-name">Fournisseur</span> (<span class="pk">id_fourn</span>, nom_societe)<br>
                        <span class="table-name">Entrepot</span> (<span class="pk">id_entrepot</span>, ville)<br>
                        <br>
                        <span class="table-name">Produit</span> (<span class="pk">ref_prod</span>, nom, prix_actuel, <span class="fk">#id_fourn</span>)<br>
                        <br>
                        <span class="table-name">Stocker</span> (<span class="pk fk">#ref_prod</span>, <span class="pk fk">#id_entrepot</span>, qte_stock)<br>
                        <span class="col">// Gestion du stock par entrepôt</span><br>
                        <br>
                        <span class="table-name">Commande</span> (<span class="pk">num_cmd</span>, date, statut, <span class="fk">#id_client</span>)<br>
                        <span class="table-name">Ligne_Commande</span> (<span class="pk fk">#num_cmd</span>, <span class="pk fk">#ref_prod</span>, qte_achat, prix_fixe)<br>
                    </div>
                </div>
            </div>

             <div class="exo-block">
                <div class="exo-title">
                    <span>#5 Gestion Scolarité ISEP</span>
                    <span class="badge">Classique</span>
                </div>
                <div class="scenario-text">
                    <p>
                        On gère une école. Il y a des Elèves (id, nom, promo). Ils suivent des Cours(Maths, Info, Elec...). Un cours est défini par un code et un nombre de crédits ECTS. 
                        A la fin du semestre, un élève obtient une note pour un cours.
                        Les cours sont enseignés par des Professeurs. Un cours peut être enseigné par plusieurs profs (plusieurs groupes), et un prof enseigne plusieurs matières. On veut savoir combien d'heures chaque prof a fait pour chaque matière.
                    </p>
                    <p>
                        Les cours ont lieu dans des Salles de classe. Pour simplifier, on considère qu'un cours est affecté principalement à une salle spécifique (ex: le labo d'élec).
                        Enfin, chaque élève appartient à une Association(BDE, JE, Sport...). Un élève ne peut être que dans une seule asso principale, mais une asso a plein de membres.
                    </p>
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Voir le Mapping Relationnel</button>
                <div class="correction">
                    <div class="db-schema">
                        <span class="table-name">Salle</span> (<span class="pk">num_salle</span>, capacite)<br>
                        <span class="table-name">Asso</span> (<span class="pk">id_asso</span>, nom_asso, budget)<br>
                        <br>
                        <span class="table-name">Cours</span> (<span class="pk">code_cours</span>, titre, ects, <span class="fk">#num_salle</span>)<br>
                        <span class="table-name">Eleve</span> (<span class="pk">id_eleve</span>, nom, <span class="fk">#id_asso</span>)<br>
                        <span class="table-name">Prof</span> (<span class="pk">id_prof</span>, nom)<br>
                        <br>
                        <span class="table-name">Bulletin</span> (<span class="pk fk">#id_eleve</span>, <span class="pk fk">#code_cours</span>, note_finale)<br>
                        <span class="table-name">Enseignement</span> (<span class="pk fk">#id_prof</span>, <span class="pk fk">#code_cours</span>, heures_effectuees)<br>
                    </div>
                </div>
            </div>
        </div>

        <div id="sens2" class="tab-content">
            <div style="background: #e3f2fd; padding: 15px; border-left: 4px solid #2196F3; margin-bottom: 20px;">
                <i class="fas fa-info-circle"></i> <strong>Consigne :</strong> Analyse les tables ci-dessous (Clés Primaires et Etrangères) et déduis-en l'histoire et les règles de gestion (les cardinalités).
            </div>

            <div class="exo-block reverse-exo">
                <div class="exo-title">#6 Analyse Immobilière</div>
                <div class="db-schema">
                    Proprio (<span class="pk">id_p</span>, nom, tel)<br>
                    Agence (<span class="pk">id_ag</span>, ville, directeur)<br>
                    Bien (<span class="pk">ref_bien</span>, adresse, prix, <span class="fk">#id_ag</span>)<br>
                    Posseder (<span class="pk fk">#ref_bien</span>, <span class="pk fk">#id_p</span>, pourcentage)
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Révéler l'Histoire</button>
                <div class="correction">
                    <div class="interpretation">
                        <ul>
                            <li><strong>Bien -> Agence (FK simple) :</strong> Un bien est géré par UNE SEULE agence (1,1). Une agence gère plusieurs biens (1,N).</li>
                            <li><strong>Posseder (Table de jointure) :</strong> Un bien peut appartenir à PLUSIEURS propriétaires (Indivision). Un propriétaire possède plusieurs biens.</li>
                            <li><strong>Attribut pourcentage :</strong> Comme il est dans la jointure, chaque propriétaire possède une part différente du bien (ex: 50% / 50%).</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="exo-block reverse-exo">
                <div class="exo-title">#7 Analyse Restaurant</div>
                <div class="db-schema">
                    Serveur (<span class="pk">id_serv</span>, nom)<br>
                    TableResto (<span class="pk">num_table</span>, nb_places, <span class="fk">#id_serv</span>)<br>
                    Plat (<span class="pk">id_plat</span>, nom, prix)<br>
                    Commande (<span class="pk">id_cmd</span>, heure, <span class="fk">#num_table</span>)<br>
                    ContenuCmd (<span class="pk fk">#id_cmd</span>, <span class="pk fk">#id_plat</span>, cuisson)
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Révéler l'Histoire</button>
                <div class="correction">
                    <div class="interpretation">
                        <ul>
                            <li><strong>Table -> Serveur :</strong> Une table est gérée par un seul serveur (c'est son rang). Un serveur gère plusieurs tables.</li>
                            <li><strong>Commande -> Table :</strong> Une commande est liée à une seule table. Une table peut passer plusieurs commandes (entrée, puis plat...).</li>
                            <li><strong>ContenuCmd :</strong> Une commande contient plusieurs plats. Un plat peut être dans plusieurs commandes. L'attribut "cuisson" (saignant, à point) dépend du plat DANS la commande.</li>
                        </ul>
                    </div>
                </div>
            </div>

             <div class="exo-block reverse-exo">
                <div class="exo-title">#8 Analyse Bibliothèque</div>
                <div class="db-schema">
                    Auteur (<span class="pk">id_aut</span>, nom)<br>
                    Livre (<span class="pk">isbn</span>, titre, <span class="fk">#id_aut</span>)<br>
                    Exemplaire (<span class="pk">code_barre</span>, etat, <span class="fk">#isbn</span>)<br>
                    Abonne (<span class="pk">num_carte</span>, nom)<br>
                    Emprunt (<span class="pk fk">#code_barre</span>, <span class="pk fk">#num_carte</span>, date_pret)
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Révéler l'Histoire</button>
                <div class="correction">
                    <div class="interpretation">
                        <ul>
                            <li><strong>Livre -> Auteur :</strong> Simplification ici : Un livre est écrit par UN SEUL auteur (FK dans Livre).</li>
                            <li><strong>Exemplaire -> Livre :</strong> Un livre (Harry Potter) a plusieurs exemplaires physiques sur les étagères. Un exemplaire correspond à un seul livre.</li>
                            <li><strong>Emprunt :</strong> C'est l'Exemplaire qui est emprunté, pas le Livre abstrait ! Un abonné emprunte un exemplaire à une date donnée.</li>
                        </ul>
                    </div>
                </div>
            </div>

             <div class="exo-block reverse-exo">
                <div class="exo-title">#9 Analyse Championnat Foot</div>
                <div class="db-schema">
                    Stade (<span class="pk">id_stade</span>, nom, ville)<br>
                    Equipe (<span class="pk">id_team</span>, nom, <span class="fk">#id_stade</span>)<br>
                    Joueur (<span class="pk">id_joueur</span>, nom, <span class="fk">#id_team</span>)<br>
                    Match (<span class="pk">id_match</span>, date, <span class="fk">#id_team_domicile</span>, <span class="fk">#id_team_exterieur</span>, score)
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Révéler l'Histoire</button>
                <div class="correction">
                    <div class="interpretation">
                        <ul>
                            <li><strong>Equipe -> Stade :</strong> Une équipe a UN stade attitré (Stade résident). Un stade peut héberger plusieurs équipes (ou une seule).</li>
                            <li><strong>Joueur -> Equipe :</strong> Un joueur joue pour une seule équipe.</li>
                            <li><strong>Match (Double FK) :</strong> C'est le piège ! Un match oppose DEUX équipes. Il y a donc deux clés étrangères pointant vers la table Equipe (Domicile et Extérieur).</li>
                        </ul>
                    </div>
                </div>
            </div>

             <div class="exo-block reverse-exo">
                <div class="exo-title">#10 Analyse Hotel</div>
                <div class="db-schema">
                    Hotel (<span class="pk">id_hotel</span>, nom, etiles)<br>
                    Chambre (<span class="pk">num_chambre</span>, etage, <span class="fk">#id_hotel</span>)<br>
                    Client (<span class="pk">id_cli</span>, nom)<br>
                    Reservation (<span class="pk">ref_resa</span>, date_debut, date_fin, <span class="fk">#id_cli</span>, <span class="fk">#num_chambre</span>)
                </div>
                <button class="btn-reveal" onclick="toggleCorr(this)">Révéler l'Histoire</button>
                <div class="correction">
                    <div class="interpretation">
                        <ul>
                            <li><strong>Chambre -> Hotel :</strong> Une chambre appartient à un seul hôtel. L'hôtel a plusieurs chambres.</li>
                            <li><strong>Reservation :</strong> Une réservation est faite par UN client pour UNE chambre spécifique (simplification).</li>
                            <li><strong>Cardinalité Reservation :</strong> Une réservation concerne une seule chambre. Une chambre peut avoir plusieurs réservations (à des dates différentes).</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();

        function openTab(tabId) {
            // Cacher tous les contenus
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            // Désactiver tous les boutons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Activer le bon
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function toggleCorr(btn) {
            const corr = btn.nextElementSibling;
            if (corr.style.display === "block") {
                corr.style.display = "none";
                btn.innerText = btn.innerText.replace("Cacher", "Voir");
            } else {
                corr.style.display = "block";
                btn.innerText = btn.innerText.replace("Voir", "Cacher") || "Cacher la correction";
            }
        }
    </script>
</body>
</html>
