<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module BDD - Focus ISEP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style_hub.css">
</head>
<body>

    <header class="hero-small">
        <div class="hero-content-box">
            <span class="badge-exam">MODE EXAMEN</span>
            <h1>Entraînement Intensif BDD</h1>
            <p>Scénarios complexes, pièges de modélisation et mapping relationnel.</p>
            <a href="app_info.html" class="btn-back"><i class="fas fa-arrow-left"></i> Retour Hub</a>
        </div>
    </header>

    <main class="container">
        
        <div class="nav-tabs-wrapper">
            <button class="tab-btn active" onclick="openTab('exos')"><i class="fas fa-pen-nib"></i> 6 Scénarios "Examen"</button>
            <button class="tab-btn" onclick="openTab('fiches')"><i class="fas fa-brain"></i> Rappels Mapping</button>
        </div>

        <div id="exos" class="tab-content active">
            
            <div class="intro-text">
                <i class="fas fa-info-circle"></i> <strong>Consigne :</strong> Lis attentivement les textes. Ils contiennent des détails superflus. Extrais les <strong>Entités</strong> (Noms), les <strong>Associations</strong> (Verbes) et déduis les <strong>Cardinalités</strong>.
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#1</span> Gestion Hôpital (Hiérarchie)</h3>
                    <span class="difficulty medium">Moyen</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Le centre hospitalier "Saint-ISEP" souhaite informatiser la gestion de ses services. L'établissement est découpé en plusieurs <strong>Services</strong> (Cardiologie, Neurologie, etc.). Chaque service est dirigé par un <strong>Médecin</strong> chef de service, mais attention, un service ne peut avoir qu'un seul chef, et un médecin ne peut diriger qu'un seul service à la fois.
                        Par ailleurs, les médecins sont rattachés à un service principal où ils exercent, mais ils ne peuvent pas appartenir à plusieurs services. Enfin, l'hôpital accueille des <strong>Patients</strong>. Un patient est admis dans un service unique à une date donnée. On souhaite conserver l'historique des admissions (date d'entrée, motif).
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr1')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr1" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>"Un service est dirigé par UN médecin, un médecin dirige UN service" -> <strong>(1,1) - (1,1)</strong> (Relation bijective/One-to-One).</li>
                                <li>"Médecins rattachés à un service" -> <strong>(1,1)</strong> côté Médecin, <strong>(1,n)</strong> côté Service.</li>
                                <li>"Patient admis dans un service + Historique" -> Relation n..n (Plusieurs admissions au cours du temps).</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Service (<u>code_service</u>, nom_service, <span class="fk">#id_chef_medecin</span>)
Medecin (<u>id_med</u>, nom, specialite, <span class="fk">#code_service_appartenance</span>)
Patient (<u>id_pat</u>, nom, n_secu)
Admission (<u>#id_pat, #code_service, date_entree</u>, motif)
                            </pre>
                            <p class="note">Note : Pour la relation Chef (1-1), on aurait pu mettre la clé étrangère dans Médecin, mais il est plus logique qu'un Service désigne son Chef.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#2</span> La Bibliothèque Municipale (Gestion fine)</h3>
                    <span class="difficulty hard">Difficile</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Nous gérons une bibliothèque qui possède des milliers de <strong>Livres</strong>. Attention, nous distinguons l'œuvre (ex: "Harry Potter") des exemplaires physiques (Le livre abîmé sur l'étagère 3). Une <strong>Œuvre</strong> est écrite par un ou plusieurs <strong>Auteurs</strong>.
                        Les <strong>Abonnés</strong> peuvent emprunter des exemplaires. Un emprunt concerne un seul exemplaire à une date précise et doit être rendu avant une date limite. Si l'abonné rend le livre en retard, une pénalité est calculée. Un livre peut être emprunté plusieurs fois dans sa vie. Il faut aussi gérer l'état du livre (Neuf, Bon, Abîmé) lors de chaque emprunt.
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr2')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr2" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>Distinction Œuvre vs Exemplaire -> <strong>1 Œuvre a n Exemplaires</strong>.</li>
                                <li>Œuvre écrite par plusieurs Auteurs -> Relation <strong>n..n</strong> (Co-écriture).</li>
                                <li>Emprunt -> Relation entre Abonné et <strong>Exemplaire</strong> (pas Œuvre !). C'est une relation historique (n..n) avec date et état.</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Auteur (<u>id_aut</u>, nom)
Oeuvre (<u>isbn</u>, titre, date_parution)
Ecrire (<u>#id_aut, #isbn</u>)  <span class="comment">// Table de jointure n..n</span>

Exemplaire (<u>id_exemp</u>, etat_actuel, <span class="fk">#isbn</span>) <span class="comment">// 1..n vers Oeuvre</span>
Abonné (<u>id_ab</u>, nom, adresse)

Emprunter (<u>#id_exemp, #id_ab, date_emprunt</u>, date_retour_reele, etat_retour)
                            </pre>
                        </div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#3</span> Gestion de Projets (La Ternaire)</h3>
                    <span class="difficulty hard">Piège</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Une entreprise de conseil souhaite suivre l'activité de ses <strong>Consultants</strong>. Ces consultants travaillent sur des <strong>Projets</strong> pour le compte de <strong>Clients</strong> finaux.
                        La règle de gestion est la suivante : Un consultant impute un nombre d'heures travaillées sur un projet spécifique pour un client donné. Par exemple, Alice a travaillé 4h sur le projet "Refonte Web" pour le client "Coca-Cola". 
                        Attention : Un même projet (ex: "Refonte Web") peut être vendu à plusieurs clients différents, et plusieurs consultants peuvent bosser dessus. Le taux horaire de facturation dépend de la combinaison (Consultant + Projet + Client).
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr3')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr3" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>Le piège ici est de faire des relations binaires séparées.</li>
                                <li>L'info (Heures + Taux) dépend des TROIS entités en même temps.</li>
                                <li>C'est une <strong>Association Ternaire</strong> (Consultant - Projet - Client).</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Consultant (<u>id_cons</u>, nom)
Projet (<u>code_prj</u>, libelle_generique)
Client (<u>id_cli</u>, raison_sociale)

Mission (<u>#id_cons, #code_prj, #id_cli</u>, nb_heures, taux_horaire)
                            </pre>
                            <p class="note">La clé primaire est composée des 3 clés étrangères !</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#4</span> Nomenclature Produit (Réflexive)</h3>
                    <span class="difficulty medium">Technique</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Dans une usine d'assemblage de vélos, on gère des <strong>Pièces</strong>. Certaines pièces sont élémentaires (vis, écrou, cadre), d'autres sont composées (une Roue est composée de : 1 jante, 32 rayons, 1 moyeu). Un vélo complet est lui-même composé de 2 Roues, 1 Cadre, etc.
                        On veut modéliser cette nomenclature. Pour chaque composition, on doit connaître la quantité nécessaire (ex: 32 rayons pour 1 roue). Une pièce peut entrer dans la composition de plusieurs autres pièces.
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr4')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr4" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>Il n'y a qu'une seule entité : <strong>Pièce</strong>.</li>
                                <li>L'association est "Composer" et elle relie Pièce à Pièce (Réflexive).</li>
                                <li>C'est du <strong>n..n</strong> (Une pièce compose plusieurs assemblages, un assemblage a plusieurs pièces).</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Piece (<u>ref_piece</u>, libelle, poids)

Nomenclature (<u>#ref_composant, #ref_compose</u>, quantite)
                            </pre>
                            <p class="note">Exemple : (ref_rayon, ref_roue, 32). Les deux clés étrangères pointent vers la table Piece.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#5</span> Agence Immobilière (Le 0..1)</h3>
                    <span class="difficulty medium">Classique</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Une agence gère des <strong>Biens</strong> immobiliers (Appartements, Maisons). Chaque bien appartient à un ou plusieurs <strong>Propriétaires</strong> (indivision). L'agence affecte un <strong>Agent</strong> commercial responsable de la vente du bien.
                        Attention aux règles : Un agent gère plusieurs biens, mais un bien est géré par un seul agent. Parfois, un bien n'a pas encore d'agent affecté (nouveau dossier). Un bien se situe dans une <strong>Ville</strong> (Code postal, Nom). Une ville contient évidemment plusieurs biens.
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr5')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr5" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>Bien - Propriétaire : <strong>n..n</strong> (Indivision).</li>
                                <li>Bien - Ville : <strong>1..n</strong> (Un bien est dans 1 ville).</li>
                                <li>Bien - Agent : <strong>0..1</strong> (Un bien a 0 ou 1 agent). C'est une relation 1..n optionnelle.</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Agent (<u>id_agent</u>, nom)
Ville (<u>code_insee</u>, nom_ville, cp)
Proprio (<u>id_prop</u>, nom, tel)

Bien (<u>id_bien</u>, surface, prix, <span class="fk">#code_insee</span>, <span class="fk">#id_agent</span>)
<span class="comment">// id_agent peut être NULL ici ! (car 0..1)</span>

Posseder (<u>#id_bien, #id_prop</u>, quote_part)
                            </pre>
                        </div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <div class="card-header">
                    <h3><span class="exo-number">#6</span> Tournoi eSport (Le Final Boss)</h3>
                    <span class="difficulty hard">Expert</span>
                </div>
                <div class="scenario-body">
                    <p class="text-content">
                        Organisons un tournoi de LoL. Nous avons des <strong>Équipes</strong> constituées de <strong>Joueurs</strong>. Un joueur appartient à une seule équipe à l'instant T. Une équipe a un Capitaine (qui est un des joueurs de l'équipe).
                        Les équipes s'affrontent dans des <strong>Matchs</strong>. Un match oppose exactement 2 équipes et se déroule à une date donnée. Le résultat (Score A, Score B) est enregistré.
                        Enfin, les matchs ont lieu dans des <strong>Arènes</strong> virtuelles (Serveurs). Un serveur accueille plusieurs matchs, mais un match est sur un seul serveur.
                    </p>
                    
                    <button class="btn-reveal" onclick="toggleCorr('corr6')">Voir l'Analyse & Mapping</button>
                    
                    <div id="corr6" class="correction-box hidden">
                        <div class="analysis">
                            <strong><i class="fas fa-search"></i> Analyse :</strong>
                            <ul>
                                <li>Equipe - Joueur : 1..n classique.</li>
                                <li>Equipe - Capitaine : 1..1 (Un joueur est capitaine, une équipe a un capitaine).</li>
                                <li>Match - Equipe : Attention ! Un match oppose 2 équipes. C'est deux relations 1..n distinctes (Equipe1 et Equipe2) ou une relation n..n ? Le mieux est de considérer "Jouer" comme n..n mais limité à 2 tuples ?
                                <br><em>Approche relationnelle propre :</em> Table Match avec 2 clés étrangères vers Equipe (Equipe_A, Equipe_B).</li>
                            </ul>
                        </div>
                        <div class="mapping-result">
                            <strong><i class="fas fa-table"></i> Mapping Relationnel :</strong>
                            <pre>
Equipe (<u>id_team</u>, nom_team, <span class="fk">#id_capitaine</span>)
Joueur (<u>id_gamer</u>, pseudo, <span class="fk">#id_team</span>)
<span class="comment">// id_capitaine est une FK vers Joueur. id_team est une FK vers Equipe. (Boucle !)</span>

Serveur (<u>ip_serv</u>, region)

Match (<u>id_match</u>, date_match, score_A, score_B, <span class="fk">#ip_serv</span>, <span class="fk">#id_team_A</span>, <span class="fk">#id_team_B</span>)
<span class="comment">// On stocke les deux équipes directement dans le match pour simplifier le duel.</span>
                            </pre>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div id="fiches" class="tab-content">
            <div class="scenario-card">
                <h2>Récapitulatif Visuel pour le Papier</h2>
                <div class="mcd-visual-guide">
                    <div class="guide-item">
                        <div class="guide-diagram"> (0,n) --- (1,1) </div>
                        <div class="guide-text">La flèche (la clé FK) va vers le (1,1).</div>
                    </div>
                    <div class="guide-item">
                        <div class="guide-diagram"> (0,n) --- (0,n) </div>
                        <div class="guide-text">Nouvelle Table au milieu (Jointure).</div>
                    </div>
                    <div class="guide-item">
                        <div class="guide-diagram"> (1,1) --- (1,1) </div>
                        <div class="guide-text">On fusionne les bulles en une seule table.</div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        function openTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function toggleCorr(id) {
            const el = document.getElementById(id);
            el.classList.toggle('hidden');
        }
    </script>
</body>
</html>
